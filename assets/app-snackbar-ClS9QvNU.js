import{At as e,Ct as t,Dt as n,Et as r,M as i,Mt as a,Ot as o,St as s,Tt as c,bt as l,c as u,m as d,wt as f,xt as p}from"./index-BtrREANE.js";var m=class extends o{#client;#currentResult=void 0;#currentMutation;#mutateOptions;constructor(e,t){super(),this.#client=e,this.setOptions(t),this.bindMethods(),this.#updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#client.defaultMutationOptions(e),r(this.options,t)||this.#client.getMutationCache().notify({type:`observerOptionsUpdated`,mutation:this.#currentMutation,observer:this}),t?.mutationKey&&this.options.mutationKey&&f(t.mutationKey)!==f(this.options.mutationKey)?this.reset():this.#currentMutation?.state.status===`pending`&&this.#currentMutation.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#currentMutation?.removeObserver(this)}onMutationUpdate(e){this.#updateResult(),this.#notify(e)}getCurrentResult(){return this.#currentResult}reset(){this.#currentMutation?.removeObserver(this),this.#currentMutation=void 0,this.#updateResult(),this.#notify()}mutate(e,t){return this.#mutateOptions=t,this.#currentMutation?.removeObserver(this),this.#currentMutation=this.#client.getMutationCache().build(this.#client,this.options),this.#currentMutation.addObserver(this),this.#currentMutation.execute(e)}#updateResult(){let e=this.#currentMutation?.state??s();this.#currentResult={...e,isPending:e.status===`pending`,isSuccess:e.status===`success`,isError:e.status===`error`,isIdle:e.status===`idle`,mutate:this.mutate,reset:this.reset}}#notify(e){t.batch(()=>{if(this.#mutateOptions&&this.hasListeners()){let t=this.#currentResult.variables,n=this.#currentResult.context,r={client:this.#client,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type===`success`?(this.#mutateOptions.onSuccess?.(e.data,t,n,r),this.#mutateOptions.onSettled?.(e.data,null,t,n,r)):e?.type===`error`&&(this.#mutateOptions.onError?.(e.error,t,n,r),this.#mutateOptions.onSettled?.(void 0,e.error,t,n,r))}this.listeners.forEach(e=>{e(this.#currentResult)})})}},h=a(e());function g(e,r){let i=l(r),[a]=h.useState(()=>new m(i,e));h.useEffect(()=>{a.setOptions(e)},[a,e]);let o=h.useSyncExternalStore(h.useCallback(e=>a.subscribe(t.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),s=h.useCallback((e,t)=>{a.mutate(e,t).catch(c)},[a]);if(o.error&&n(a.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:s,mutateAsync:o.mutate}}const _=()=>{let e=l();return g({mutationFn:e=>u.login(e),onSuccess:async()=>{try{let t=await u.getMe();e.setQueryData([`auth`,`profile`],t)}catch(e){console.error(`❌ Failed to prefetch profile after login:`,e)}}})},v=()=>{let e=l();return g({mutationFn:e=>u.signUp(e),onSuccess:async()=>{try{let t=await u.getMe();e.setQueryData([`auth`,`profile`],t)}catch(e){console.error(`❌ Failed to prefetch profile after sign-up:`,e)}}})};var y=`/E-commerce-d/assets/login-CgtRTIYq.jpg`,b=a(p()),x=({open:e,message:t,severity:n=`success`,onClose:r,autoHideDuration:a=3e3})=>(0,b.jsx)(d,{open:e,autoHideDuration:a,onClose:r,anchorOrigin:{vertical:`bottom`,horizontal:`center`},sx:{zIndex:e=>e.zIndex.drawer+3},children:(0,b.jsxs)(i,{onClose:r,severity:n,icon:!1,sx:{width:`100%`,display:`flex`,alignItems:`center`,gap:1,borderRadius:`8px`,backgroundColor:n===`success`?`#4caf50`:`#f44336`,color:`#fff`,fontWeight:500,boxShadow:`0px 4px 20px rgba(0,0,0,0.1)`},children:[n===`success`?`✅`:`❌`,` `,t]})});export{v as i,y as n,_ as r,x as t};